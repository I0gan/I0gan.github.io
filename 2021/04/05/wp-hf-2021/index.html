<!DOCTYPE html><html lang="zh" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>虎符网络安全大赛之零解 | I0gan</title><meta name="keywords" content="wp"><meta name="author" content="i0gan"><meta name="copyright" content="i0gan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Hu Fu 2021 Online 之零解Intro这次比赛一个都没做出来，菜～，这篇文章主要重新复现一下没做出来的PWN题，这次比赛既然把两个区块链的题放入了PWN中，我们队伍也没人去研究那玩意儿，以后有时间可以去了解一下。。。这次主要还是WEB输出高，REVERSE也不错，我菜得抠脚QAQ。 Misc你会分析日志吗通过分析日志，发现请求长度有两个399和377，都是采用sql注入，将日志中sl">
<meta property="og:type" content="article">
<meta property="og:title" content="虎符网络安全大赛之零解">
<meta property="og:url" content="http://i0gan.pwnsky.com/2021/04/05/wp-hf-2021/index.html">
<meta property="og:site_name" content="I0gan">
<meta property="og:description" content="Hu Fu 2021 Online 之零解Intro这次比赛一个都没做出来，菜～，这篇文章主要重新复现一下没做出来的PWN题，这次比赛既然把两个区块链的题放入了PWN中，我们队伍也没人去研究那玩意儿，以后有时间可以去了解一下。。。这次主要还是WEB输出高，REVERSE也不错，我菜得抠脚QAQ。 Misc你会分析日志吗通过分析日志，发现请求长度有两个399和377，都是采用sql注入，将日志中sl">
<meta property="og:locale">
<meta property="og:image" content="http://i0gan.pwnsky.com/img/text_bg.jpg">
<meta property="article:published_time" content="2021-04-05T11:07:00.000Z">
<meta property="article:modified_time" content="2021-04-05T12:56:10.217Z">
<meta property="article:author" content="i0gan">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://i0gan.pwnsky.com/img/text_bg.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://i0gan.pwnsky.com/2021/04/05/wp-hf-2021/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-04-05 20:56:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/header.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">68</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">30</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">24</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/text_bg.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">I0gan</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">虎符网络安全大赛之零解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-04-05T11:07:00.000Z" title="Created 2021-04-05 19:07:00">2021-04-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-04-05T12:56:10.217Z" title="Updated 2021-04-05 20:56:10">2021-04-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pwn/">pwn</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Hu-Fu-2021-Online-之零解"><a href="#Hu-Fu-2021-Online-之零解" class="headerlink" title="Hu Fu 2021 Online 之零解"></a>Hu Fu 2021 Online 之零解</h1><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>这次比赛一个都没做出来，菜～，这篇文章主要重新复现一下没做出来的PWN题，这次比赛既然把两个区块链的题放入了PWN中，我们队伍也没人去研究那玩意儿，以后有时间可以去了解一下。。。这次主要还是WEB输出高，REVERSE也不错，我菜得抠脚QAQ。</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="你会分析日志吗"><a href="#你会分析日志吗" class="headerlink" title="你会分析日志吗"></a>你会分析日志吗</h3><p>通过分析日志，发现请求长度有两个399和377，都是采用sql注入，将日志中sleep函数前面的一个数字提取出来即可。</p>
<pre><code>192.168.52.156 - - [11/Mar/2021:18:04:27 +0000] &quot;GET /index.php?id=1&#39;%20and%20if(ord(substr((select%20flag%20from%20flllag),34,1))=83,sleep(2),1)--+ HTTP/1.1&quot; 200 399 &quot;-&quot; &quot;python-requests/2.21.0&quot;</code></pre>
<p>这里也就是83</p>
<p>通过提取长度为377请求中的数字，执行命令进行提取</p>
<pre><code>cat access.log| grep &quot;377&quot; | grep &quot;select%20flag%20from%20flllag&quot; | tr -d &quot;a-z()[]\&quot;&#39;/A-Z %.+?-&quot; |  awk -F &#39;=&#39; &#39;&#123;print $3 &#125;&#39; | cut -d &#39;,&#39; -f 1 | tr &quot;\n&quot; &quot;,&quot;</code></pre>
<p>或</p>
<pre><code>cat access.log| grep &quot;377&quot; | grep &quot;select%20flag%20from%20flllag&quot; | cut -d &#39;=&#39; -f 3 | cut -d &#39;,&#39; -f 1 | tr &quot;\n&quot; &quot;,&quot;</code></pre>
<p>输出如下</p>
<pre><code>90,109,120,104,90,51,116,90,98,51,86,102,89,88,74,108,88,51,78,118,88,50,100,121,90,87,70,48,102,81,61,61,</code></pre>
<pre class=" language-python"><code class="language-python">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> a<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></code></pre>
<p>打印出该字符为: ZmxhZ3tZb3VfYXJlX3NvX2dyZWF0fQ==</p>
<p>base64进行解密: </p>
<pre><code>echo &quot;ZmxhZ3tZb3VfYXJlX3NvX2dyZWF0fQ==&quot; | base64 -d 
flag&#123;You_are_so_great&#125;</code></pre>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p>PWN逆了半天，调试了半天。。。逻辑都没进入，一个字菜～。这次PWN题基本算是VM类型的，grira没办法把某些代码反编译，IDA虽然能反编译汇编，但是伪代码还是存在不能完全反编译。aarch64指令又难看，ememme~。另一个题我看了下，感觉也跟这个差不多，然后我也没很细的看那道题，继续分析apollo，下午太困了，搞不出来，睡觉～～～。这次比赛采用跳转表，只能看汇编动态分析，c伪代码根本不知道在干啥玩意儿！</p>
<h3 id="apollo"><a href="#apollo" class="headerlink" title="apollo"></a>apollo</h3><h4 id="hint"><a href="#hint" class="headerlink" title="hint"></a>hint</h4><p>hint1: 附件补充aarch64库，同时此题的难点在于vm虚拟机的分析。 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_RgBNGCBzJeBqlFKDBV0xg">https://pan.baidu.com/s/1_RgBNGCBzJeBqlFKDBV0xg</a> 提取码：GAME。</p>
<p>hint2: 漏洞点在于车辆前方的绿灯或红灯的转化，使车辆到达了地图外</p>
<p>各个函数伪c代码如下</p>
<h5 id="main-函数"><a href="#main-函数" class="headerlink" title="main 函数"></a>main 函数</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// w0</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>v4<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x1</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x2</span>

  <span class="token function">init_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">logo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">run</span><span class="token punctuation">(</span>v3<span class="token punctuation">,</span> v4<span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="run-函数"><a href="#run-函数" class="headerlink" title="run 函数"></a>run 函数</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [xsp+18h] [xbp+18h]</span>

  input_ptr <span class="token operator">=</span> <span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x1000uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>input_ptr <span class="token punctuation">)</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Init fail!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cmd> "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>input_ptr<span class="token punctuation">,</span> <span class="token number">0x1000uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> v4 <span class="token operator">^</span> _stack_chk_guard<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="parse函数"><a href="#parse函数" class="headerlink" title="parse函数"></a>parse函数</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">sub_E14</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  _QWORD v0<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [xsp+58h] [xbp+58h]</span>

  v0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_0<span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_9<span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_a<span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_b<span class="token punctuation">;</span>
  __asm <span class="token punctuation">{</span> BR              X0 <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="mul-1018函数"><a href="#mul-1018函数" class="headerlink" title="mul_1018函数"></a>mul_1018函数</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">mul_1018</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>
  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// w19</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_1 = *(opcode_ptr + 1)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_2 = *(opcode_ptr + 2)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_3 = *(opcode_ptr + 3)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_4 = *(opcode_ptr + 4)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">68</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// size = var_4 * 0x10 + var_3</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_l          <span class="token comment" spellcheck="true">// check (var_1 &lt; size_l &amp;&amp; var_2 &lt; size_r)</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_r
      <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// *(buf_1 + size_r * var_1 + var_2) == 0</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">68</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span>                  <span class="token comment" spellcheck="true">// check (size > 0 &amp;&amp; size &lt;= 0x600)</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">68</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0x600</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// *(buf_1 + size_r * var_1 + var_2) = 1, malloc_flag</span>
      v1 <span class="token operator">=</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// v1 = size_r * var_1 + var_2</span>
      <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>ptr_ <span class="token operator">+</span> v1<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">68</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// *(ptr + size_r * var_1 + var_2) =  malloc(size)</span>
      <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>ptr_ <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">68</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// read(0, *(ptr + size_r * var_1 + var_2), size)</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">5LL</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">// opcode ptr += 5</span>
      <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment" spellcheck="true">// jump table</span>
    <span class="token punctuation">}</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0x256CLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment" spellcheck="true">// abort</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="div-11f4"><a href="#div-11f4" class="headerlink" title="div_11f4"></a>div_11f4</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">div_11F4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>                                             <span class="token comment" spellcheck="true">// just tack two param</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_1 = *(opcode_ptr + 1)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_2 = *(opcode_ptr + 2)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_l          <span class="token comment" spellcheck="true">// check (var_1 &lt; size_l &amp;&amp; var_2 &lt; size_r)</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_r
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token comment" spellcheck="true">// check malloc flag</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>ptr_ <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">// check buf is not null</span>
    <span class="token punctuation">{</span>
      <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>ptr_ <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// free(buf);</span>
      <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>ptr_ <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// buf=0;</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// set malloc flag as 0</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">3LL</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">// opcode_ptr +=3</span>
      <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0x256CLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="plus-1394"><a href="#plus-1394" class="headerlink" title="plus_1394"></a>plus_1394</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">plus_1394</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_1 = *(opcode_ptr + 1)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_2 = *(opcode_ptr + 2)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">56</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_3 = *(opcode_ptr + 3)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_l          <span class="token comment" spellcheck="true">// check (var_1 &lt; size_l &amp;&amp; var_2 &lt; size_r)</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_r
      <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// *(buf_1 + size_r * var_1 + var_2) != 0</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">56</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span>                  <span class="token comment" spellcheck="true">// check (var_1 > 1  &amp;&amp; var_2 &lt;= 4)</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">56</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">4</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// *(buf_1 + size_r * var_1 + var_2) = var_3</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">4LL</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">// opcode ptr += 4</span>
      <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0x256CLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="sub-14d4"><a href="#sub-14d4" class="headerlink" title="_sub_14d4"></a>_sub_14d4</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">sub_14D4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_1 = *(opcode_ptr + 1)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// var_2 = *(opcode_ptr + 2)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_l          <span class="token comment" spellcheck="true">// check (var_1 &lt; size_l &amp;&amp; var_2 &lt; size_r)</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_r
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1u</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">4u</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">// check (var_1 > 1  &amp;&amp; var_2 &lt;= 4)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf_1 <span class="token operator">+</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// *(buf_1 + size_r * var_1 + var_2) = 0</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">3LL</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">// opcode ptr += 3</span>
      <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0x256CLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="w-1620"><a href="#w-1620" class="headerlink" title="w_1620"></a>w_1620</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">w_1620</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>
  <span class="token keyword">char</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// w0</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> vertical <span class="token operator">></span> <span class="token number">0</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
          <span class="token operator">||</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
          vertical <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">{</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token operator">--</span>vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    v1 <span class="token operator">=</span> dword_14080<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>qword_14090 <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>
    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">// opcode_ptr ++</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="s-1990"><a href="#s-1990" class="headerlink" title="s_1990"></a>s_1990</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">s_1990</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>
  <span class="token keyword">char</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// w0</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> size_l <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">></span> vertical
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
          <span class="token operator">||</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token punctuation">(</span>vertical <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
          vertical <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">{</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token operator">++</span>vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    v1 <span class="token operator">=</span> dword_14080<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>qword_14090 <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>
    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">// opcode_ptr ++</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="a-1d10"><a href="#a-1d10" class="headerlink" title="a_1d10"></a>a_1d10</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">a_1d10</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>
  <span class="token keyword">char</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// w0</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> horizontal <span class="token operator">></span> <span class="token number">0</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">-</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">-</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">-</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">-</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
          <span class="token operator">||</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">-</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">-</span> <span class="token number">2LL</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
          horizontal <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">{</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token operator">--</span> <span class="token operator">-</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    v1 <span class="token operator">=</span> dword_14080<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>qword_14090 <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>
    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">// opcode_ptr ++</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token comment" spellcheck="true">// loop jump</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="d-2080"><a href="#d-2080" class="headerlink" title="d_2080"></a>d_2080</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">d_2080</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>
  <span class="token keyword">char</span> v1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// w0</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> size_r <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">></span> horizontal
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span>
      <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
          <span class="token operator">||</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal <span class="token operator">+</span> <span class="token number">2LL</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
          horizontal <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">{</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token operator">++</span> <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    v1 <span class="token operator">=</span> dword_14080<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>qword_14090 <span class="token operator">+</span> vertical <span class="token operator">*</span> size_r <span class="token operator">+</span> horizontal<span class="token punctuation">)</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>
    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">// opcode_ptr ++</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token comment" spellcheck="true">// abort</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Abort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="print-2400"><a href="#print-2400" class="headerlink" title="print_2400"></a>print_2400</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">print_2400</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> enter_flag <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> size_l <span class="token operator">*</span> size_r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span> <span class="token operator">/</span> size_r<span class="token punctuation">;</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">44</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span> <span class="token operator">-</span> size_r <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_ <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pos:%d,%d\n"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">44</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>ptr_ <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">// opcode_ptr ++</span>
    <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0x25B8LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="get-next"><a href="#get-next" class="headerlink" title="get_next"></a>get_next</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">sub_2514</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// x29</span>

  <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">0x48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">// opcode_ptr ++</span>
  <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0xED0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="exit"><a href="#exit" class="headerlink" title="exit_"></a>exit_</h5><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> __noreturn <span class="token function">exit_</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Finish"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>I dubugging this program, I found just input ‘awdsp+-*/‘ making the program aborted.</p>
<p>So input map followings:</p>
<p>set breaking pinter: b *(0x5500000000 + 0xED0 ) </p>
<p>a: 0x5500001d10</p>
<p>w:0x5500001620</p>
<p>d: 0x5500002080</p>
<p>s: 0x5500001990</p>
<p>+: 0x5500001394</p>
<p>-: 0x55000014d4</p>
<p>*: 0x5500001018</p>
<p>/: 0x55000011f4</p>
<p>p: 0x5500002400</p>
<p>enter_flag: 0x5500014098</p>
<p>基本上能翻译为c伪装代码的就这几个函数，但是，enter_flag不知道该怎么设置为0。逻辑都进不去@_@。上面这个是在比赛那天分析的一部分。</p>
<h4 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h4><p>该程序存在一些函数跳转表，在parse函数下，ida反编译如下:</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">sub_E14</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  _QWORD v0<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [xsp+58h] [xbp+58h]</span>

  v0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_0<span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_9<span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_a<span class="token punctuation">;</span>
  v0<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> func_b<span class="token punctuation">;</span>
  __asm <span class="token punctuation">{</span> BR              X0 <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>当时我还以为是寄存器的初始化，一直搞不明白它是怎么跳的。通过看汇编代码，通过下断点进行动态分析:</p>
<p><code>b *(0x5500000000 + 0xe14)</code> 如下:</p>
<p>sub_E14</p>
<pre><code>.text:0000000000000E14                 STP             X29, X30, [SP,#var_C0]!
.text:0000000000000E18                 MOV             X29, SP
.text:0000000000000E1C                 STR             X19, [SP,#0xC0+var_B0]
.text:0000000000000E20                 ADRP            X0, #__stack_chk_guard_ptr@PAGE
.text:0000000000000E24                 LDR             X0, [X0,#__stack_chk_guard_ptr@PAGEOFF]; 获取只读页基址,
.text:0000000000000E28                 LDR             X1, [X0] ; 获取cannary值
.text:0000000000000E2C                 STR             X1, [X29,#0xC0+var_8]; 储存cannary值在堆栈里
.text:0000000000000E30                 MOV             X1, #0
.text:0000000000000E34                 ADRP            X0, #reg_1@PAGE ; 获取data段基址，这里存放的是函数跳转表
.text:0000000000000E38                 ADD             X1, X0, #reg_1@PAGEOFF ; x1, x0, #0x10
.text:0000000000000E3C                 ADD             X0, X29, #0x58 ; 开始从虚函数表中赋值到堆栈中
.text:0000000000000E40                 LDP             X2, X3, [X1]; 加载第一个函数地址, 0x5500000eb8
.text:0000000000000E44                 STP             X2, X3, [X0]; 赋值到堆栈中
.text:0000000000000E48                 LDP             X2, X3, [X1,#0x10] ; 加载第二个函数地址, 0x55000011f4
.text:0000000000000E4C                 STP             X2, X3, [X0,#0x10]
.text:0000000000000E50                 LDP             X2, X3, [X1,#0x20] ; 加载第三个函数地址, 0x55000014d4
.text:0000000000000E54                 STP             X2, X3, [X0,#0x20]
.text:0000000000000E58                 LDP             X2, X3, [X1,#0x30] ; 加载第三个函数地址, 0x5500001990
.text:0000000000000E5C                 STP             X2, X3, [X0,#0x30]
.text:0000000000000E60                 LDP             X2, X3, [X1,#0x40] ; 加载第四个函数地址, 0x5500002080
.text:0000000000000E64                 STP             X2, X3, [X0,#0x40]
.text:0000000000000E68                 LDP             X1, X2, [X1,#0x50] ; 加载第四个函数地址, 0x5500002514
.text:0000000000000E6C                 STP             X1, X2, [X0,#0x50]
.text:0000000000000E70                 ADRP            X0, #off_13F98@PAGE ; 获取堆栈基址
.text:0000000000000E74                 LDR             X0, [X0,#off_13F98@PAGEOFF] ; 通过堆栈某变量获取在bss段储存输入的指针变量
.text:0000000000000E78                 LDR             X0, [X0] ; 通过该变量获取储存输入的堆指针
.text:0000000000000E7C                 STR             X0, [X29,#0xC0+var_78] ; 将该指针储存在堆栈 var_78 处
.text:0000000000000E80                 LDR             X0, [X29,#0xC0+var_78] ;
.text:0000000000000E84                 STR             X0, [X29,#0xC0+var_70] ; 将该指针储存在堆栈 var_78 处
.text:0000000000000E88                 LDR             X0, [X29,#0xC0+var_78] ;
.text:0000000000000E8C                 LDRB            W0, [X0] ; 取出输入的地一个字节
.text:0000000000000E90                 MOV             W1, W0 ;将第一个字节放在w1中
.text:0000000000000E94                 ADRP            X0, #off_13FE8@PAGE ; 获取只读页的base address
.text:0000000000000E98                 LDR             X0, [X0,#off_13FE8@PAGEOFF] ;opcode跳转表 0x5500003770 ◂— 0xb0000000a
.text:0000000000000E9C                 SXTW            X1, W1 ;拓展为64位, 这里还是输入数据的第一个字节
.text:0000000000000EA0                 LDR             W0, [X0,X1,LSL#2]; ；x0 + x1*4计算出来的地址读取一字节到w0中，这里x1是我们输入的一字节, x0就是opcode跳转表地址
.text:0000000000000EA4                 SXTW            X0, W0  # 拓展为64位
.text:0000000000000EA8                 LSL             X0, X0, #3 ;左移3位
.text:0000000000000EAC                 ADD             X1, X29, #0x58 ; 获取之前加载的函数跳转表
.text:0000000000000EB0                 LDR             X0, [X1,X0] ; 计算通过获取[x1 + x0]得到真正的函数地址
.text:0000000000000EB4                 B               loc_ED0</code></pre>
<p>loc_ED0</p>
<pre><code>.text:0000000000000ED0 loc_ED0                                 ; CODE XREF: parse+A0↑j
.text:0000000000000ED0                                         ; parse+200↓j ...
.text:0000000000000ED0                 BR              X0 ; 跳到x0指向的地址</code></pre>
<p>函数跳转表如下：</p>
<pre><code>.data:0000000000014010 func_0          DCQ init_program        ; DATA XREF: parse+20↑o
.data:0000000000014010                                         ; parse+24↑o
.data:0000000000014018 func_1          DCQ mul_1018
.data:0000000000014020 func_2          DCQ div_11F4
.data:0000000000014028 func_3          DCQ plus_1394
.data:0000000000014030 func_4          DCQ _sub_14d4
.data:0000000000014038 func_5          DCQ w_1620
.data:0000000000014040 func_6          DCQ s_1990
.data:0000000000014048 func_7          DCQ a_1d10
.data:0000000000014050 func_8          DCQ d_2080
.data:0000000000014058 func_9          DCQ print_2400
.data:0000000000014060 func_a          DCQ exit_
.data:0000000000014068 func_b          DCQ get_next</code></pre>
<p>opcode 跳转表如下: 0x5500003770</p>
<pre><code>0A 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 00   [00 -&gt; exit_]
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 08
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 10
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 18
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 20
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  01 00 00 00 03 00 00 00 ; 28   [2a -&gt; mul_1018, 2b -&gt; plus_1394]
0B 00 00 00 04 00 00 00  0B 00 00 00 02 00 00 00 ;      [2d -&gt; _sub_14d4, 2f -&gt; div_11F4]
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 30
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 38
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 40
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 48
0B 00 00 00 00 00 00 00  0B 00 00 00 0B 00 00 00        [4d -&gt; init_program]
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 50
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 58
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 07 00 00 00  0B 00 00 00 0B 00 00 00 ; 60   [61 -&gt; a_1d10]
08 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00        [64 -&gt; d_2080]
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 68
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
09 00 00 00 0B 00 00 00  0B 00 00 00 06 00 00 00 ; 70   [70 -&gt; print_2400, 73 -&gt; s_1990]
0B 00 00 00 0B 00 00 00  0B 00 00 00 05 00 00 00        [77 -&gt; w_1620]
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 78
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 80
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 88
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 90
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; 98
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; a0
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; a8
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; b0
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; b8
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; c0
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; c8
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; d0
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; d8
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; e0
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; e8
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; f0
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00 ; f8
0B 00 00 00 0B 00 00 00  0B 00 00 00 0B 00 00 00</code></pre>
<p>经过调试, 对应opcode * 4之后跳转如下:</p>
<p>通过分析，程序采用 function_table[opcode_table[opcode * 4]]</p>
<p>所以对应查找出opcode对应函数如下:</p>
<p>00 -&gt; exit_</p>
<p>2a -&gt; mul_1018</p>
<p>2b -&gt; plus_1394</p>
<p>2d -&gt; _sub_14d4</p>
<p>2f -&gt; div_11F4</p>
<p>4d -&gt; init_program (EB8)</p>
<p>61 -&gt; a_1d10</p>
<p>64 -&gt; d_2080</p>
<p>70 -&gt; print_2400</p>
<p>73 -&gt; s_1990</p>
<p>77 -&gt; w_1620</p>
<p>而其他的opcode在opcode_table[opcode * 4]之后，都会去执行 get_next (2514) 函数</p>
<p>通过逆向分析，程序进行逻辑交互，则必须要的使enter_flag(14098)变量赋值为1才能进行交互，不然都是执行abort，然而init_program这个分支是不能伪代码反编译的，应该加了花指令，在ghidra下直接不能反编译为汇编。这只能得看汇编了。</p>
<pre><code>.text:0000000000000EB8 init_program                            ; DATA XREF: .data:func_0↓o
.text:0000000000000EB8                 ADRP            X0, #off_13F90@PAGE ; 获取bss段base adreess
.text:0000000000000EBC                 LDR             X0, [X0,#off_13F90@PAGEOFF] ; 获取enter_flag变量地址
.text:0000000000000EC0                 LDR             W0, [X0] ; 获取enter_flag变量的值
.text:0000000000000EC4                 CMP             W0, #0 ; 与0做对比，若等于0跳到 loc_ED4处,初始化的时候,enter_flag值是为0的
.text:0000000000000EC8                 B.NE            loc_2564
.text:0000000000000ECC                 B               loc_ED4</code></pre>
<p>跳到loc_ED4，这里也没办法反编译，又只能看汇编QAQ。。。</p>
<pre><code>.text:0000000000000ED4 loc_ED4                                 ; CODE XREF: parse+B8↑j
.text:0000000000000ED4                 LDR             X0, [X29,#0xC0+var_78] ; 获取输入数据的指针 opcode_ptr = buf_ptr
.text:0000000000000ED8                 ADD             X0, X0, #1 ; opcode_ptr += 1
.text:0000000000000EDC                 LDRB            W0, [X0]; 获取opcode_ptr指向的该值
.text:0000000000000EE0                 MOV             W1, W0 ; 赋值给w1
.text:0000000000000EE4                 ADRP            X0, #off_13FD8@PAGE 
.text:0000000000000EE8                 LDR             X0, [X0,#off_13FD8@PAGEOFF] ; 获取对应变量size_l (1409C)
.text:0000000000000EEC                 STR             W1, [X0] ; 将opcde_ptr对应的一字节赋值给size_l
.text:0000000000000EF0                 LDR             X0, [X29,#0xC0+var_78] ; 重新获取输入数据指针, 相当于 opcode_ptr = buf_ptr
.text:0000000000000EF4                 ADD             X0, X0, #2 ; opcode_ptr += 2
.text:0000000000000EF8                 LDRB            W0, [X0] ; 获取输入数据的第3个值
.text:0000000000000EFC                 MOV             W1, W0 ; 赋值给w1
.text:0000000000000F00                 ADRP            X0, #off_13F68@PAGE
.text:0000000000000F04                 LDR             X0, [X0,#off_13F68@PAGEOFF] ; 获取对应变量size_r (140A0)
.text:0000000000000F08                 STR             W1, [X0] ; 将输入数据的第3个值赋值给该变量
.text:0000000000000F0C                 ADRP            X0, #off_13FD8@PAGE
.text:0000000000000F10                 LDR             X0, [X0,#off_13FD8@PAGEOFF] ; 获取变量size_l地址
.text:0000000000000F14                 LDR             W0, [X0] ; 获取size_l中的单字节数据
.text:0000000000000F18                 CMP             W0, #0x10 ; 判断size_l == 0x10
.text:0000000000000F1C                 B.GT            loc_256C ; 大于的话，退出
.text:0000000000000F20                 ADRP            X0, #off_13F68@PAGE
.text:0000000000000F24                 LDR             X0, [X0,#off_13F68@PAGEOFF] ; 获取size_r地址
.text:0000000000000F28                 LDR             W0, [X0] ; 获取size_r中的单字节数据
.text:0000000000000F2C                 CMP             W0, #0x10 ; 判断size_r == 0x10
.text:0000000000000F30                 B.GT            loc_256C  ; 大于的话，退出
.text:0000000000000F34                 ADRP            X0, #off_13FD8@PAGE
.text:0000000000000F38                 LDR             X0, [X0,#off_13FD8@PAGEOFF] ; 获取变量size_l地址
.text:0000000000000F3C                 LDR             W0, [X0]  ; 获取size_l中的单字节数据
.text:0000000000000F40                 CMP             W0, #3  ; size_l与3做比较，若小于等于3，退出
.text:0000000000000F44                 B.LE            loc_256C
.text:0000000000000F48                 ADRP            X0, #off_13F68@PAGE 
.text:0000000000000F4C                 LDR             X0, [X0,#off_13F68@PAGEOFF] ; 获取变量size_r地址
.text:0000000000000F50                 LDR             W0, [X0]
.text:0000000000000F54                 CMP             W0, #3 ; size_r与3做比较，若小于等于3，退出
.text:0000000000000F58                 B.LE            loc_256C
.text:0000000000000F5C                 ADRP            X0, #off_13FD8@PAGE
.text:0000000000000F60                 LDR             X0, [X0,#off_13FD8@PAGEOFF] ; 获取变量size_l地址
.text:0000000000000F64                 LDR             W1, [X0]
.text:0000000000000F68                 ADRP            X0, #off_13F68@PAGE
.text:0000000000000F6C                 LDR             X0, [X0,#off_13F68@PAGEOFF] ; 获取变量size_r地址
.text:0000000000000F70                 LDR             W0, [X0]
.text:0000000000000F74                 MUL             W0, W1, W0 ; w0 = size_l * size_r
.text:0000000000000F78                 SXTW            X0, W0  ; nmemb
.text:0000000000000F7C                 MOV             X1, #1  ; size
.text:0000000000000F80                 BL              .calloc ; 调用calloc(size_l * size_r)
.text:0000000000000F84                 MOV             X1, X0  ; 将返回值赋给x1
.text:0000000000000F88                 ADRP            X0, #off_13F80@PAGE
.text:0000000000000F8C                 LDR             X0, [X0,#off_13F80@PAGEOFF] ; 获取变量 buf_1 (14088) 地址
.text:0000000000000F90                 STR             X1, [X0] ; 开辟的内存指针 放在变量 buf_1中
.text:0000000000000F94                 ADRP            X0, #off_13FD8@PAGE
.text:0000000000000F98                 LDR             X0, [X0,#off_13FD8@PAGEOFF] ; 获取变量size_l地址
.text:0000000000000F9C                 LDR             W1, [X0]
.text:0000000000000FA0                 ADRP            X0, #off_13F68@PAGE
.text:0000000000000FA4                 LDR             X0, [X0,#off_13F68@PAGEOFF] ; 获取变量size_r地址
.text:0000000000000FA8                 LDR             W0, [X0]
.text:0000000000000FAC                 MUL             W0, W1, W0 ; w0 = size_l * size_r
.text:0000000000000FB0                 SXTW            X0, W0  ; nmemb
.text:0000000000000FB4                 MOV             X1, #1  ; size
.text:0000000000000FB8                 BL              .calloc ; 再开辟一次 calloc(size_l * size_r)
.text:0000000000000FBC                 MOV             X1, X0
.text:0000000000000FC0                 ADRP            X0, #off_13FF0@PAGE
.text:0000000000000FC4                 LDR             X0, [X0,#off_13FF0@PAGEOFF] ; 获取变量 buf_2 (14090) 地址
.text:0000000000000FC8                 STR             X1, [X0] ; 开辟的内存指针 放在变量 buf_2中
.text:0000000000000FCC                 ADRP            X0, #off_13F90@PAGE
.text:0000000000000FD0                 LDR             X0, [X0,#off_13F90@PAGEOFF] ; 获取enter_flag变量的地址
.text:0000000000000FD4                 MOV             W1, #1
.text:0000000000000FD8                 STR             W1, [X0] ; 给enter_flag变量赋值为1
.text:0000000000000FDC                 LDR             X0, [X29,#0xC0+var_78] ; 获取输入数据的指针 opcode_ptr = buf_ptr
.text:0000000000000FE0                 ADD             X0, X0, #3 ; opcode += 3
.text:0000000000000FE4                 STR             X0, [X29,#0xC0+var_78] ; 设置buf_ptr = opcode_ptr
.text:0000000000000FE8                 LDR             X0, [X29,#0xC0+var_78] ; 获取该opcode_ptr
.text:0000000000000FEC                 LDRB            W0, [X0] ; 获取该opcode_ptr指向的值
.text:0000000000000FF0                 MOV             W1, W0
.text:0000000000000FF4                 ADRP            X0, #off_13FE8@PAGE
.text:0000000000000FF8                 LDR             X0, [X0,#off_13FE8@PAGEOFF] ; opcode_table的地址
.text:0000000000000FFC                 SXTW            X1, W1
.text:0000000000001000                 LDR             W0, [X0,X1,LSL#2] ;通过opcode查找函数跳转表的索引
.text:0000000000001004                 SXTW            X0, W0
.text:0000000000001008                 LSL             X0, X0, #3
.text:000000000000100C                 ADD             X1, X29, #0x58 ; 获取函数跳转表地址
.text:0000000000001010                 LDR             X0, [X1,X0] ; 获取真正要跳转的地址
.text:0000000000001014                 B               loc_ED0
.text:0000000000001014 ; End of function parse</code></pre>
<p>通过以上我大致写一下伪c代码吧:</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">init_program</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>opcode_ptr_ptr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>opcode_ptr <span class="token operator">=</span> <span class="token operator">*</span>opcode_ptr_ptr<span class="token punctuation">;</span>
    opcode_ptr <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    size_l <span class="token operator">=</span> <span class="token operator">*</span>opcode_ptr<span class="token punctuation">;</span>
    opcode_ptr <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    size_r <span class="token operator">=</span> <span class="token operator">*</span>opcode_ptr<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>size_r <span class="token operator">></span> <span class="token number">0x10</span> <span class="token operator">||</span> size_l <span class="token operator">></span> <span class="token number">0x10</span> <span class="token operator">||</span> size_r <span class="token operator">&lt;=</span> <span class="token number">3</span> <span class="token operator">||</span> size_l <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">exit_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    buf_1 <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span>size_l <span class="token operator">*</span> size_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    buf_2 <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span>size_l <span class="token operator">*</span> size_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    enter_flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>opcode_ptr_ptr <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    jump function_table<span class="token punctuation">[</span><span class="token function">opcode_table</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">*</span>opcode_ptr_ptr<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">// 这里的opcode_table()代表是通过一系列操作得到的函数表索引</span>
<span class="token punctuation">}</span></code></pre>
<p>进入该函数 opcode = ‘4d’ + ‘0x00’ + ‘0x01’, 然后这里的’0x00’是要赋值给size_l，’0x01’赋值给size_r。</p>
<p>想要进入其他函数，不abort的情况下就的使enter_flag不为0了，调用init_program这个分支是第一步，这样才能操作其他函数。</p>
<p>好了基本所有函数逻辑已经清楚明白了，我没该怎么利用？漏洞在哪？</p>
<p>hint2提示: 漏洞点在于车辆前方的绿灯或红灯的转化，使车辆到达了地图外</p>
<p>车是什么玩意？ 红绿灯？地图？</p>
<p>通过分析<code>mul_1018</code>, <code>div_11f4</code>，<code>plus_1394</code>，<code>_sub_14d4</code> 都没发现漏洞QAQ。</p>
<p>WEB</p>
<h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>师傅们常说，要善于学习，细致入微；师傅们也常说，要善于分享，总结归纳。 </p>
<p>hint:</p>
<p>2021年3月28日，PHP维护的官方Git服务器 git.php.net 被袭击，其Git仓库遭到恶意篡改。如果开发者使用这些遭到篡改的源代码进行网页的开发的话，网站就会在不知情的情况下被感染。</p>
<p>不知道什么东西</p>
<pre><code></code></pre>
<p>是一个个人博客</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">i0gan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://i0gan.pwnsky.com/2021/04/05/wp-hf-2021/">http://i0gan.pwnsky.com/2021/04/05/wp-hf-2021/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post_share"><div class="social-share" data-image="/img/text_bg.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/07/01/gsky-1/"><img class="prev-cover" src="/img/text_bg.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">gsky简易高性能游戏服务器框架库介绍</div></div></a></div><div class="next-post pull-right"><a href="/2021/04/02/wp-hong-ming-gu/"><img class="next-cover" src="/img/text_bg.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">The Writeup Of Hong Ming Gu Cup Online</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2020/09/02/wp-2020-ciscn/" title="2020 CISCN PWN WP"><img class="cover" src="/img/text_bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-02</div><div class="title">2020 CISCN PWN WP</div></div></a></div><div><a href="/2020/09/01/wp-2020-qwb/" title="wp 2020强网杯"><img class="cover" src="/img/text_bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-01</div><div class="title">wp 2020强网杯</div></div></a></div><div><a href="/2020/09/22/wp-down-under-ctf/" title="wp DownUnderCTF"><img class="cover" src="/img/text_bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-22</div><div class="title">wp DownUnderCTF</div></div></a></div><div><a href="/2020/06/18/wp-hfb-2020/" title="wp-hfb-2020"><img class="cover" src="/img/text_bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-18</div><div class="title">wp-hfb-2020</div></div></a></div><div><a href="/2021/01/08/wp-huawei-xctf-2020/" title="HUAWEI XCTF 2020 PWN WRITE UP"><img class="cover" src="/img/text_bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-08</div><div class="title">HUAWEI XCTF 2020 PWN WRITE UP</div></div></a></div><div><a href="/2020/09/26/wp-jk-2020/" title="极客巅峰2020"><img class="cover" src="/img/text_bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-26</div><div class="title">极客巅峰2020</div></div></a></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/header.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">i0gan</div><div class="author-info__description">起床时想到你的微笑，洗脸时嗅到你的味道，上床前你是我的需要，真的不能离开你-我亲爱的马桶！</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">68</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">30</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">24</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/i0gan"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Hu-Fu-2021-Online-%E4%B9%8B%E9%9B%B6%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">Hu Fu 2021 Online 之零解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Intro"><span class="toc-number">1.1.</span> <span class="toc-text">Intro</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E4%BC%9A%E5%88%86%E6%9E%90%E6%97%A5%E5%BF%97%E5%90%97"><span class="toc-number">1.2.1.</span> <span class="toc-text">你会分析日志吗</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">1.3.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#apollo"><span class="toc-number">1.3.1.</span> <span class="toc-text">apollo</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hint"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">hint</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.1.1.1.</span> <span class="toc-text">main 函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#run-%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.1.1.2.</span> <span class="toc-text">run 函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#parse%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.1.1.3.</span> <span class="toc-text">parse函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mul-1018%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.1.1.4.</span> <span class="toc-text">mul_1018函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#div-11f4"><span class="toc-number">1.3.1.1.5.</span> <span class="toc-text">div_11f4</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#plus-1394"><span class="toc-number">1.3.1.1.6.</span> <span class="toc-text">plus_1394</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sub-14d4"><span class="toc-number">1.3.1.1.7.</span> <span class="toc-text">_sub_14d4</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#w-1620"><span class="toc-number">1.3.1.1.8.</span> <span class="toc-text">w_1620</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#s-1990"><span class="toc-number">1.3.1.1.9.</span> <span class="toc-text">s_1990</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#a-1d10"><span class="toc-number">1.3.1.1.10.</span> <span class="toc-text">a_1d10</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#d-2080"><span class="toc-number">1.3.1.1.11.</span> <span class="toc-text">d_2080</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#print-2400"><span class="toc-number">1.3.1.1.12.</span> <span class="toc-text">print_2400</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#get-next"><span class="toc-number">1.3.1.1.13.</span> <span class="toc-text">get_next</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#exit"><span class="toc-number">1.3.1.1.14.</span> <span class="toc-text">exit_</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">复现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">签到</span></a></li></ol></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/07/13/leetcode-3-two-sum/" title="Leet Code-3. Longest Substring Without Repeating Characters"><img src="/img/text_bg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Leet Code-3. Longest Substring Without Repeating Characters"/></a><div class="content"><a class="title" href="/2021/07/13/leetcode-3-two-sum/" title="Leet Code-3. Longest Substring Without Repeating Characters">Leet Code-3. Longest Substring Without Repeating Characters</a><time datetime="2021-07-13T03:06:00.000Z" title="Created 2021-07-13 11:06:00">2021-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/13/leetcode-2-add-two-numbers/" title="Leet Code-2. Add Two Numbers"><img src="/img/text_bg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Leet Code-2. Add Two Numbers"/></a><div class="content"><a class="title" href="/2021/07/13/leetcode-2-add-two-numbers/" title="Leet Code-2. Add Two Numbers">Leet Code-2. Add Two Numbers</a><time datetime="2021-07-13T01:14:00.000Z" title="Created 2021-07-13 09:14:00">2021-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/13/leetcode-1-two-sum/" title="Leet Code-1. Two Sum"><img src="/img/text_bg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Leet Code-1. Two Sum"/></a><div class="content"><a class="title" href="/2021/07/13/leetcode-1-two-sum/" title="Leet Code-1. Two Sum">Leet Code-1. Two Sum</a><time datetime="2021-07-13T00:07:00.000Z" title="Created 2021-07-13 08:07:00">2021-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/05/gsky-2/" title="Gsky游戏服务器框架介绍 2"><img src="/img/text_bg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gsky游戏服务器框架介绍 2"/></a><div class="content"><a class="title" href="/2021/07/05/gsky-2/" title="Gsky游戏服务器框架介绍 2">Gsky游戏服务器框架介绍 2</a><time datetime="2021-07-05T04:00:00.000Z" title="Created 2021-07-05 12:00:00">2021-07-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/02/des/" title="DES加解密-简单原理与go语言实现"><img src="/img/text_bg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DES加解密-简单原理与go语言实现"/></a><div class="content"><a class="title" href="/2021/07/02/des/" title="DES加解密-简单原理与go语言实现">DES加解密-简单原理与go语言实现</a><time datetime="2021-07-02T04:00:00.000Z" title="Created 2021-07-02 12:00:00">2021-07-02</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/text_bg.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By i0gan</div><div class="framework-info"></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.gov.cn/"><img class="icp-icon" src="/img/icp.png" alt="ICP"/><span>黔ICP备20006037号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>